<ResourceDictionary mc:Ignorable="cs"
                    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:cs="colorscheme_ignorable_uri"
                    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
                    xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
                    xmlns:dxdo="http://schemas.devexpress.com/winfx/2008/xaml/docking"
                    xmlns:dxdv="http://schemas.devexpress.com/winfx/2008/xaml/documentviewer"
                    xmlns:dxdvt="http://schemas.devexpress.com/winfx/2008/xaml/documentviewer/themekeys"
                    xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
                    xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
                    xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
                    xmlns:dxp="http://schemas.devexpress.com/winfx/2008/xaml/printing"
                    xmlns:dxpbars="http://schemas.devexpress.com/winfx/2008/xaml/printing/bars"
                    xmlns:dxpn="http://schemas.devexpress.com/winfx/2008/xaml/printing/native"
                    xmlns:dxpp="http://schemas.devexpress.com/winfx/2008/xaml/printing/parameters"
                    xmlns:dxpt="http://schemas.devexpress.com/winfx/2008/xaml/printing/themekeys"
                    xmlns:dxr="http://schemas.devexpress.com/winfx/2008/xaml/ribbon"
                    xmlns:dxt="http://schemas.devexpress.com/winfx/2008/xaml/core/themekeys"
                    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                    xmlns:sys="clr-namespace:System;assembly=mscorlib"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:xtraprintingnative="clr-namespace:DevExpress.XtraPrinting.Native;assembly=DevExpress.Printing.v22.2.Core">

    <sys:Boolean x:Key="TrueBoolean">True</sys:Boolean>

    <sys:Boolean x:Key="FalseBoolean">false</sys:Boolean>

    <BooleanToVisibilityConverter x:Key="booleanToVisibilityConverter"/>

    <dxpn:NumberToVisibilityConverter x:Key="visibilityConverter"/>

    <dxpn:ObjectToCollectionConverter x:Key="objectToCollectionConverter"/>

    <dx:ObjectToBooleanConverter x:Key="objectToBooleanConverter"/>

    <dx:BoolToVisibilityConverter x:Key="boolToVisibilityConverter"/>

    <dxp:CursorModeToCanMouseScrollConverter x:Key="cursorModeToCanMouseScrollConverter"/>

    <sys:Double x:Key="zoomComboBoxWidth">100</sys:Double>

    <dx:FormatStringConverter x:Key="pageCountFormatStringConverter" FormatString="/ {0}"/>

    <dx:BoolInverseConverter x:Key="boolInverseConverter"/>

    <DataTemplate x:Key="{dxpt:NewDocumentViewerThemeKey ResourceKey=PaginationTemplate}">
        <Grid Margin="10,0,10,0">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).CurrentPageNumber, RelativeSource={RelativeSource TemplatedParent}}"/>
                <TextBlock Text=" / "/>
                <TextBlock Text="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).PageCount, RelativeSource={RelativeSource TemplatedParent}}"/>
            </StackPanel>
        </Grid>
    </DataTemplate>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.DocumentPreviewBarButtonItem}" TargetType="{x:Type dxpbars:DocumentPreviewBarButtonItem}">
        <Setter Property="Content" Value="{Binding Path=Caption}"/>
        <Setter Property="Hint" Value="{Binding Path=Hint}"/>
        <Setter Property="Glyph" Value="{Binding Path=SmallGlyph}"/>
        <Setter Property="LargeGlyph" Value="{Binding Path=LargeGlyph}"/>
        <Setter Property="GlyphAlignment" Value="Top"/>
    </Style>

    <dxdv:CheckBarItemTemplateSelector x:Key="checkItemTemplateSelector"/>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.DocumentPreviewBarSubItem}" TargetType="{x:Type dxpbars:DocumentPreviewBarSubItem}">
        <Setter Property="Content" Value="{Binding Path=Caption}"/>
        <Setter Property="Hint" Value="{Binding Path=Hint}"/>
        <Setter Property="Glyph" Value="{Binding Path=SmallGlyph}"/>
        <Setter Property="LargeGlyph" Value="{Binding Path=LargeGlyph}"/>
        <Setter Property="GlyphAlignment" Value="Top"/>
        <Setter Property="ItemLinksSource" Value="{Binding Path=Items}"/>
        <Setter Property="ItemTemplateSelector" Value="{StaticResource checkItemTemplateSelector}"/>
    </Style>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.DocumentPreviewBarCheckItem}" TargetType="{x:Type dxpbars:DocumentPreviewBarCheckItem}">
        <Setter Property="Content" Value="{Binding Path=Caption}"/>
        <Setter Property="Hint" Value="{Binding Path=Hint}"/>
        <Setter Property="Glyph" Value="{Binding Path=SmallGlyph}"/>
        <Setter Property="LargeGlyph" Value="{Binding Path=LargeGlyph}"/>
        <Setter Property="GlyphAlignment" Value="Top"/>
        <Setter Property="IsChecked" Value="{Binding Path=IsChecked, Mode=OneWay}"/>
    </Style>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.PageLayoutBarSubItem}" TargetType="{x:Type dxpbars:PageLayoutBarSubItem}">
        <Setter Property="SubItemsGlyphSize" Value="Large"/>
        <Setter Property="Content" Value="{Binding Path=Caption}"/>
        <Setter Property="Hint" Value="{Binding Path=Hint}"/>
        <Setter Property="Glyph" Value="{Binding Path=SmallGlyph}"/>
        <Setter Property="LargeGlyph" Value="{Binding Path=LargeGlyph}"/>
        <Setter Property="GlyphAlignment" Value="Top"/>
        <Setter Property="ItemLinksSource" Value="{Binding Path=Items}"/>
        <Setter Property="ItemTemplate">
            <Setter.Value>
                <DataTemplate>
                    <ContentControl>
                        <dxpbars:PageLayoutBarCheckItem Command="{Binding}"/>
                    </ContentControl>
                </DataTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="ItemTemplateSelector" Value="{x:Null}"/>
    </Style>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.SelectToolBarItem}"
           BasedOn="{StaticResource {dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.DocumentPreviewBarCheckItem}}"
           TargetType="{x:Type dxpbars:SelectToolBarItem}">
        <Setter Property="CommandParameter" Value="{Binding Path=CommandValue}"/>
    </Style>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.HandToolBarItem}"
           BasedOn="{StaticResource {dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.DocumentPreviewBarCheckItem}}"
           TargetType="{x:Type dxpbars:HandToolBarItem}">
        <Setter Property="CommandParameter" Value="{Binding Path=CommandValue}"/>
    </Style>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.PageNumberEditItem}" TargetType="{x:Type dxpbars:PageNumberEditItem}">
        <Setter Property="Content" Value="{dxp:PrintingStringId StringId=GoToPage}"/>
        <Setter Property="Content2" Value="{Binding Path=SettingsSource.PageCount, Converter={StaticResource pageCountFormatStringConverter}, RelativeSource={RelativeSource Self}}"/>
        <Setter Property="EditValue" Value="{Binding Mode=TwoWay, UpdateSourceTrigger=Explicit, Path=SettingsSource.CurrentPageNumber, FallbackValue=0, RelativeSource={RelativeSource Self}}"/>
        <Setter Property="IsEnabled" Value="{Binding SettingsSource.PageCount, FallbackValue=False, RelativeSource={RelativeSource Self}}"/>
        <Setter Property="EditStyle">
            <Setter.Value>
                <Style x:Key="{dxt:DefaultStyleThemeKey FullName=http://schemas.devexpress.com/winfx/2008/xaml/editors.TextEdit}" TargetType="{x:Type dxe:TextEdit}">
                    <Setter Property="Padding" Value="0,-2,0,-2"/>
                    <Setter Property="MinWidth" Value="30"/>
                </Style>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.ExportSplitItem}" TargetType="{x:Type dxpbars:ExportSplitItem}">
        <Setter Property="Content" Value="{Binding Path=Caption}"/>
        <Setter Property="Hint" Value="{Binding Path=Hint}"/>
        <Setter Property="Glyph" Value="{Binding Path=SmallGlyph}"/>
        <Setter Property="LargeGlyph" Value="{Binding Path=LargeGlyph}"/>
        <Setter Property="GlyphAlignment" Value="Top"/>
    </Style>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.ZoomFactorEditItem}" TargetType="{x:Type dxpbars:ZoomFactorEditItem}">
        <Setter Property="Content" Value="{Binding SettingsSource.ZoomFactor, FallbackValue={x:Null}, Converter={dxmvvm:FormatStringConverter FormatString=P0}, RelativeSource={RelativeSource Self}}"/>
        <Setter Property="EditValue" Value="{Binding SettingsSource.ZoomFactor, FallbackValue=1, Converter={dxpn:TrackBarZoomValueConverter MinZoomValue=0.1, MaxZoomValue=5}, RelativeSource={RelativeSource Self}}"/>
        <Setter Property="IsEnabled" Value="{Binding SettingsSource.ZoomFactor, FallbackValue=False, RelativeSource={RelativeSource Self}}"/>
    </Style>

    <Style x:Key="exportItemStyleBase" TargetType="{x:Type dxb:BarButtonItem}">
        <Setter Property="Hint" Value="{Binding Path=Hint}"/>
        <Setter Property="Glyph" Value="{Binding Path=SmallGlyph}"/>
        <Setter Property="LargeGlyph" Value="{Binding Path=LargeGlyph}"/>
        <Setter Property="GlyphAlignment" Value="Top"/>
        <Setter Property="CommandParameter" Value="{Binding Format}"/>
        <Setter Property="Command" Value="{Binding}"/>
        <Setter Property="Content" Value="{Binding}"/>
        <Setter Property="ContentTemplate">
            <Setter.Value>
                <DataTemplate>
                    <StackPanel>
                        <TextBlock Text="{Binding Caption, Mode=OneWay}"/>
                        <TextBlock Opacity="0.5" Text="{Binding Tag, Mode=OneWay}"/>
                    </StackPanel>
                </DataTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <DataTemplate x:Key="{dxpt:NewDocumentViewerThemeKey  ResourceKey=ExportPopupMenuItemTemplate}">
        <ContentControl>
            <dxb:BarButtonItem dxp:DocumentPreviewControl.BarItemName="{Binding Path=Format, StringFormat=bExport{0}}" Style="{StaticResource exportItemStyleBase}"/>
        </ContentControl>
    </DataTemplate>

    <DataTemplate x:Key="{dxpt:NewDocumentViewerThemeKey  ResourceKey=SendPopupMenuItemTemplate}">
        <ContentControl>
            <dxb:BarButtonItem dxp:DocumentPreviewControl.BarItemName="{Binding Path=Format, StringFormat=bSend{0}}" Style="{StaticResource exportItemStyleBase}"/>
        </ContentControl>
    </DataTemplate>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.ProgressEditItem}" TargetType="{x:Type dxpbars:ProgressEditItem}">
        <Setter Property="EditValue" Value="{Binding ProgressSettings.ProgressPosition, Mode=OneWay, FallbackValue=0, RelativeSource={RelativeSource Self}}"/>
        <Setter Property="IsVisible" Value="{Binding ProgressSettings.InProgress, FallbackValue={StaticResource FalseBoolean}, RelativeSource={RelativeSource Self}}"/>
        <Setter Property="EditStyle">
            <Setter.Value>
                <Style x:Key="{dxt:DefaultStyleThemeKey FullName=http://schemas.devexpress.com/winfx/2008/xaml/editors.ProgressBarEdit}" TargetType="{x:Type dxe:ProgressBarEdit}">
                    <Setter Property="MinWidth" Value="150"/>
                    <Setter Property="ContentDisplayMode" Value="Value"/>
                    <Setter Property="DisplayFormatString" Value="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).Document.ProgressDisplayText, RelativeSource={RelativeSource Self}}"/>
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="EditHeight" Value="22"/>
    </Style>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.StopPageBuildItem}" TargetType="{x:Type dxpbars:StopPageBuildItem}">
        <Setter Property="IsVisible" Value="{Binding IsEnabled, RelativeSource={RelativeSource Self}}"/>
    </Style>

    <DataTemplate x:Key="{dxpt:NewDocumentViewerThemeKey ResourceKey=NavigationPaneDockLayoutTemplate}">
        <dxdo:DockLayoutManager Background="Transparent"
                                DisposeOnWindowClosing="False"
                                ViewStyle="Light"
                                cs:id="DockLayoutManager_0000">
            <dxmvvm:Interaction.Behaviors>
                <dxpn:HideClosingItemsBehavior/>
            </dxmvvm:Interaction.Behaviors>
            <dxdo:LayoutGroup>
                <dxdo:LayoutGroup ItemWidth="300"
                                  MinWidth="150"
                                  Orientation="Vertical">
                    <dxdo:LayoutPanel Caption="{dxp:PrintingStringId StringId=Parameters}">
                        <dxdo:LayoutPanel.Visibility>
                            <MultiBinding FallbackValue="Collapsed" Mode="TwoWay">
                                <MultiBinding.Converter>
                                    <dxp:DockPanelVisibilityConverter/>
                                </MultiBinding.Converter>
                                <Binding Mode="TwoWay"
                                         Path="(dxp:DocumentPreviewControl.ActualViewer).PropertyProvider.ShowParametersPanel"
                                         RelativeSource="{RelativeSource TemplatedParent}"/>
                                <Binding Mode="OneWay"
                                         Path="(dxp:DocumentPreviewControl.ActualViewer).ParameterPanelViewModel.HasVisibleParameters"
                                         RelativeSource="{RelativeSource TemplatedParent}"/>
                                <Binding Mode="OneWay"
                                         Path="(dxp:DocumentPreviewControl.ActualViewer).AutoShowParametersPanel"
                                         RelativeSource="{RelativeSource TemplatedParent}"/>
                            </MultiBinding>
                        </dxdo:LayoutPanel.Visibility>
                        <dxpp:ParametersPanel IsEnabled="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).Document.IsCreating, Converter={StaticResource boolInverseConverter}, RelativeSource={RelativeSource Self}}" ParametersModel="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ParameterPanelViewModel, RelativeSource={RelativeSource Self}}">
                            <dxmvvm:Interaction.Behaviors>
                                <dxpn:LegacyParametersPanelModelSwitcher/>
                            </dxmvvm:Interaction.Behaviors>
                        </dxpp:ParametersPanel>
                    </dxdo:LayoutPanel>
                    <dxdo:LayoutPanel Caption="{dxp:PrintingStringId StringId=NavigationPane_Title}">
                        <dxdo:LayoutPanel.Visibility>
                            <MultiBinding FallbackValue="Collapsed" Mode="TwoWay">
                                <MultiBinding.Converter>
                                    <dxp:DockPanelVisibilityConverter/>
                                </MultiBinding.Converter>
                                <Binding Mode="TwoWay"
                                         Path="(dxp:DocumentPreviewControl.ActualViewer).ShowNavigationPane"
                                         RelativeSource="{RelativeSource TemplatedParent}"/>
                                <Binding Converter="{StaticResource objectToBooleanConverter}"
                                         Mode="OneWay"
                                         Path="(dxp:DocumentPreviewControl.ActualViewer).Document"
                                         RelativeSource="{RelativeSource TemplatedParent}"/>
                            </MultiBinding>
                        </dxdo:LayoutPanel.Visibility>
                        <dxp:NavigationPaneControl Margin="12,12,12,0"/>
                    </dxdo:LayoutPanel>
                </dxdo:LayoutGroup>
                <dxdo:LayoutPanel Name="DocumentViewerPanel"
                                  AllowClose="False"
                                  AllowDrag="False"
                                  Background="Transparent"
                                  Caption="{dxp:PrintingStringId StringId=ToolBarCaption}"
                                  ShowBorder="False"
                                  ShowCaption="False"
                                  cs:id="LayoutPanel_0000">
                    <ContentPresenter Content="{Binding}"/>
                </dxdo:LayoutPanel>
            </dxdo:LayoutGroup>
        </dxdo:DockLayoutManager>
    </DataTemplate>

    <DataTemplate x:Key="{dxpt:NewDocumentViewerThemeKey ResourceKey=SeparatePanelsDockLayoutTemplate}">
        <dxdo:DockLayoutManager Background="Transparent"
                                DisposeOnWindowClosing="False"
                                cs:id="DockLayoutManager_0000">
            <dxmvvm:Interaction.Behaviors>
                <dxpn:HideClosingItemsBehavior/>
            </dxmvvm:Interaction.Behaviors>
            <dxdo:LayoutGroup>
                <dxdo:LayoutGroup ItemWidth="250" Orientation="Vertical">
                    <dxdo:LayoutPanel Caption="{dxp:PrintingStringId StringId=Parameters}">
                        <dxdo:LayoutPanel.Visibility>
                            <MultiBinding FallbackValue="Collapsed" Mode="TwoWay">
                                <MultiBinding.Converter>
                                    <dxp:DockPanelVisibilityConverter/>
                                </MultiBinding.Converter>
                                <Binding Mode="TwoWay"
                                         Path="(dxp:DocumentPreviewControl.ActualViewer).PropertyProvider.ShowParametersPanel"
                                         RelativeSource="{RelativeSource TemplatedParent}"/>
                                <Binding Mode="OneWay"
                                         Path="(dxp:DocumentPreviewControl.ActualViewer).ParameterPanelViewModel.HasVisibleParameters"
                                         RelativeSource="{RelativeSource TemplatedParent}"/>
                                <Binding Mode="OneWay"
                                         Path="(dxp:DocumentPreviewControl.ActualViewer).AutoShowParametersPanel"
                                         RelativeSource="{RelativeSource TemplatedParent}"/>
                            </MultiBinding>
                        </dxdo:LayoutPanel.Visibility>
                        <dxpp:ParametersPanel IsEnabled="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).Document.IsCreating, Converter={StaticResource boolInverseConverter}, RelativeSource={RelativeSource Self}}" ParametersModel="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ParameterPanelViewModel, RelativeSource={RelativeSource Self}}">
                            <dxmvvm:Interaction.Behaviors>
                                <dxpn:LegacyParametersPanelModelSwitcher/>
                            </dxmvvm:Interaction.Behaviors>
                        </dxpp:ParametersPanel>
                    </dxdo:LayoutPanel>
                    <dxdo:LayoutPanel Caption="{dxp:PrintingStringId StringId=DocumentMap}">
                        <dxdo:LayoutPanel.Visibility>
                            <MultiBinding FallbackValue="Collapsed" Mode="TwoWay">
                                <MultiBinding.Converter>
                                    <dxp:DockPanelVisibilityConverter/>
                                </MultiBinding.Converter>
                                <Binding Mode="TwoWay"
                                         Path="(dxp:DocumentPreviewControl.ActualViewer).PropertyProvider.ShowDocumentMap"
                                         RelativeSource="{RelativeSource TemplatedParent}"/>
                                <Binding Mode="OneWay"
                                         Path="(dxp:DocumentPreviewControl.ActualViewer).Document.HasBookmarks"
                                         RelativeSource="{RelativeSource TemplatedParent}"/>
                                <Binding Mode="OneWay"
                                         Path="(dxp:DocumentPreviewControl.ActualViewer).AutoShowDocumentMap"
                                         RelativeSource="{RelativeSource TemplatedParent}"/>
                            </MultiBinding>
                        </dxdo:LayoutPanel.Visibility>
                        <dxpn:DocumentMap SelectedItem="{Binding ActualSettings.SelectedNode, RelativeSource={RelativeSource Self}}" Settings="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualDocumentMapSettings, RelativeSource={RelativeSource TemplatedParent}}"/>
                    </dxdo:LayoutPanel>
                    <dxdo:LayoutPanel Caption="{dxp:PrintingStringId StringId=Thumbnails}">
                        <dxdo:LayoutPanel.Visibility>
                            <MultiBinding FallbackValue="Collapsed" Mode="TwoWay">
                                <MultiBinding.Converter>
                                    <dxp:DockPanelVisibilityConverter/>
                                </MultiBinding.Converter>
                                <Binding Mode="TwoWay"
                                         Path="(dxp:DocumentPreviewControl.ActualViewer).ShowThumbnails"
                                         RelativeSource="{RelativeSource TemplatedParent}"/>
                                <Binding Converter="{StaticResource objectToBooleanConverter}"
                                         Mode="OneWay"
                                         Path="(dxp:DocumentPreviewControl.ActualViewer).Document"
                                         RelativeSource="{RelativeSource TemplatedParent}"/>
                            </MultiBinding>
                        </dxdo:LayoutPanel.Visibility>
                        <dxpn:ThumbnailsViewerControl SelectedPageNumber="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).CurrentPageNumber, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" Settings="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ThumbnailsSettings, RelativeSource={RelativeSource TemplatedParent}}"/>
                    </dxdo:LayoutPanel>
                </dxdo:LayoutGroup>
                <dxdo:LayoutPanel Name="DocumentViewerPanel"
                                  AllowDrag="False"
                                  Background="Transparent"
                                  Caption="{dxp:PrintingStringId StringId=ToolBarCaption}"
                                  ShowBorder="False"
                                  ShowCaption="False"
                                  cs:id="LayoutPanel_0000">
                    <ContentPresenter Content="{Binding}"/>
                </dxdo:LayoutPanel>
            </dxdo:LayoutGroup>
        </dxdo:DockLayoutManager>
    </DataTemplate>

    <DataTemplate x:Key="{dxpt:NewDocumentViewerThemeKey ResourceKey=PresenterTemplate}">
        <Grid>
            <dxpn:PreviewSurface/>
            <ContentControl ContentTemplate="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=NavigationPaneDockLayoutTemplate}}">
                <dxmvvm:Interaction.Behaviors>
                    <dxpn:DocumentPreviewDockingLayoutTemplateUpdater UseNavigationPaneTemplate="{Binding Path=AssociatedObject.(dxp:DocumentPreviewControl.ActualViewer).UseOfficeInspiredNavigationPane, RelativeSource={RelativeSource Self}}"/>
                </dxmvvm:Interaction.Behaviors>
                <dxp:DocumentPresenterControl>
                    <dxb:BarManager.DXContextMenu>
                        <dxb:PopupMenu>
                            <dxpbars:HandToolBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.HandToolCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.HandTool}"/>
                            <dxpbars:SelectToolBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SelectToolCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.SelectTool}"/>
                            <dxb:BarItemSeparator/>
                            <dxpbars:CopyBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.CopyCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Copy}"/>
                        </dxb:PopupMenu>
                    </dxb:BarManager.DXContextMenu>
                </dxp:DocumentPresenterControl>
            </ContentControl>
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="{dxpt:NewDocumentViewerThemeKey ResourceKey=BarsTemplate}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="auto"/>
            </Grid.RowDefinitions>
            <dxb:BarContainerControl>
                <dxb:ToolBarControl AllowCustomizationMenu="False"
                                    AllowHide="False"
                                    Caption="{dxp:PrintingStringId StringId=ToolBarCaption}"
                                    dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Bar}"
                                    GlyphSize="Large"
                                    UseWholeRow="True">
                    <dxmvvm:Interaction.Behaviors>
                        <dxb:ControllerBehavior Actions="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.Actions, RelativeSource={RelativeSource TemplatedParent}}" ExecutionMode="OnEvent">
                            <dxb:ControllerBehavior.Triggers>
                                <dxb:ActionTrigger EventName="Loaded" ExecuteOnce="True"/>
                            </dxb:ControllerBehavior.Triggers>
                        </dxb:ControllerBehavior>
                    </dxmvvm:Interaction.Behaviors>
                    <dxpbars:OpenBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.OpenDocumentCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Open}"/>
                    <dxpbars:SaveBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SaveCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Save}"/>
                    <dxb:BarItemLinkSeparator/>
                    <dxpbars:ParametersBarCheckItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleParametersPanelCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Parameters}"/>
                    <dxpbars:DocumentMapBarCheckItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleDocumentMapCommand, RelativeSource={RelativeSource TemplatedParent}}"
                                                     dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.DocumentMap}"
                                                     IsVisible="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).UseOfficeInspiredNavigationPane, RelativeSource={RelativeSource TemplatedParent}, Converter={dxmvvm:BooleanNegationConverter}, FallbackValue=False}"/>
                    <dxpbars:ThumbnailsBarCheckItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleThumbnailsCommand, RelativeSource={RelativeSource TemplatedParent}}"
                                                    dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Thumbnails}"
                                                    IsVisible="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).UseOfficeInspiredNavigationPane, RelativeSource={RelativeSource TemplatedParent}, Converter={dxmvvm:BooleanNegationConverter}, FallbackValue=False}"/>
                    <dxpbars:EditingFieldsBarCheckItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleEditingFieldsCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.EditingFields}"/>
                    <dxpbars:FindTextBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ShowFindTextCommand, RelativeSource={RelativeSource TemplatedParent}}"
                                             CommandParameter="{StaticResource TrueBoolean}"
                                             dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Find}"/>
                    <dxb:BarItemLinkSeparator/>
                    <dxpbars:PrintBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PrintCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Print}"/>
                    <dxpbars:PrintDirectBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PrintDirectCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.PrintDirect}"/>
                    <dxpbars:PageSetupBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PageSetupCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.PageSetup}"/>
                    <dxpbars:ScaleBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ScaleCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Scale}"/>
                    <dxb:BarItemLinkSeparator/>
                    <dxpbars:FirstPageBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.FirstPageCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.FirstPage}"/>
                    <dxpbars:PreviousPageBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PreviousPageCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.PreviousPage}"/>
                    <dxpbars:NextPageBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.NextPageCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.NextPage}"/>
                    <dxpbars:LastPageBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.LastPageCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.LastPage}"/>
                    <dxpbars:NavigationPaneBarCheckItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleNavigationPaneCommand, RelativeSource={RelativeSource TemplatedParent}}"
                                                        dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.NavigationPane}"
                                                        IsVisible="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).UseOfficeInspiredNavigationPane, RelativeSource={RelativeSource TemplatedParent}, FallbackValue=True}"/>
                    <dxb:BarItemLinkSeparator/>
                    <dxpbars:ZoomOutBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ZoomOutCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.ZoomOut}"/>
                    <dxpbars:ZoomBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ZoomCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Zoom}"/>
                    <dxpbars:ZoomInBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ZoomInCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.ZoomIn}"/>
                    <dxb:BarItemLinkSeparator/>
                    <dxpbars:PageLayoutBarSubItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SetPageLayoutSplitCommand, RelativeSource={RelativeSource TemplatedParent}}"
                                                  dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.PageLayoutSplit}"
                                                  SubItemsGlyphSize="Small"/>
                    <dxpbars:ContinuousScrollingBarCheckItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleEnableContinuousScrollingCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.ContinuousScrolling}"/>
                    <dxpbars:CoverPageBarCheckItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleShowCoverPageCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.ShowCoverPage}"/>
                    <dxb:BarItemLinkSeparator/>
                    <dxpbars:ExportSplitItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ExportSplitCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Export}"/>
                    <dxpbars:SendSplitItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SendSplitCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Send}"/>
                    <dxpbars:WatermarkBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SetWatermarkCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Watermark}"/>
                </dxb:ToolBarControl>
            </dxb:BarContainerControl>
            <ContentControl ContentTemplate="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=PresenterTemplate}}"
                            Grid.Row="1"
                            UseLayoutRounding="True"/>
            <dxb:StatusBarControl AllowCustomizationMenu="False"
                                  Caption="{dxp:PrintingStringId StringId=StatusBarCaption}"
                                  dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.StatusBar}"
                                  Grid.Row="2">
                <dxpbars:PageNumberEditItem dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.PageNumber}" SettingsSource="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer), RelativeSource={RelativeSource TemplatedParent}}"/>
                <dxpbars:ProgressEditItem dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Progress}" ProgressSettings="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).Document, RelativeSource={RelativeSource TemplatedParent}, FallbackValue={x:Null}}"/>
                <dxpbars:StopPageBuildItem Command="{Binding  Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.StopPageBuildingCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.StopBuilding}"/>
                <dxpbars:ZoomFactorEditItem Alignment="Far"
                                            dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.ZoomFactor}"
                                            SettingsSource="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer), RelativeSource={RelativeSource TemplatedParent}}"/>
            </dxb:StatusBarControl>
        </Grid>
    </DataTemplate>

    <Style x:Key="{dxpt:NewDocumentViewerThemeKey ResourceKey=RibbonStyle}" TargetType="{x:Type dxr:RibbonControl}">
        <Setter Property="ToolbarShowMode" Value="Hide"/>
        <Setter Property="RibbonTitleBarVisibility" Value="Collapsed"/>
        <Setter Property="RibbonStyle" Value="Office2010"/>
        <Setter Property="HideEmptyGroups" Value="True"/>
        <Setter Property="AllowCustomization" Value="False"/>
    </Style>

    <DataTemplate x:Key="{dxpt:NewDocumentViewerThemeKey ResourceKey=RibbonTemplate}">
        <Grid>
            <dxmvvm:Interaction.Behaviors>
                <dxb:ControllerBehavior Actions="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.RibbonActions, RelativeSource={RelativeSource TemplatedParent}}" ExecutionMode="OnEvent">
                    <dxb:ControllerBehavior.Triggers>
                        <dxb:ActionTrigger EventName="Loaded" ExecuteOnce="True"/>
                    </dxb:ControllerBehavior.Triggers>
                </dxb:ControllerBehavior>
            </dxmvvm:Interaction.Behaviors>
            <Grid.RowDefinitions>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="auto"/>
            </Grid.RowDefinitions>
            <dxr:RibbonControl dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Ribbon}"
                               Focusable="False"
                               Style="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=RibbonStyle}}">
                <dxr:RibbonControl.ApplicationMenu>
                    <dxr:ApplicationMenu Name="menu">
                        <dxb:BarButtonItemLink BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Open}"/>
                        <dxb:BarButtonItemLink BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Save}"/>
                        <dxb:BarItemSeparator/>
                        <dxb:BarButtonItemLink BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Print}"/>
                    </dxr:ApplicationMenu>
                </dxr:RibbonControl.ApplicationMenu>
                <dxr:RibbonDefaultPageCategory>
                    <dxr:RibbonPage Caption="{dxp:PrintingStringId StringId=RibbonPageCaption}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.PreviewPage}">
                        <dxr:RibbonPageGroup Caption="{dxp:PrintingStringId StringId=RibbonPageGroup_File}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.FileGroup}">
                            <dxpbars:OpenBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.OpenDocumentCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Open}"/>
                            <dxpbars:SaveBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SaveCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Save}"/>
                        </dxr:RibbonPageGroup>
                        <dxr:RibbonPageGroup Caption="{dxp:PrintingStringId StringId=RibbonPageGroup_Print}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.PrintGroup}">
                            <dxpbars:PrintBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PrintCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Print}"/>
                            <dxpbars:PrintDirectBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PrintDirectCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.PrintDirect}"/>
                            <dxpbars:PageSetupBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PageSetupCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.PageSetup}"/>
                            <dxpbars:ScaleBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ScaleCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Scale}"/>
                        </dxr:RibbonPageGroup>
                        <dxr:RibbonPageGroup Caption="{dxp:PrintingStringId StringId=RibbonPageGroup_Navigation}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.NavigationGroup}">
                            <dxpbars:FirstPageBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.FirstPageCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.FirstPage}"/>
                            <dxpbars:PreviousPageBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PreviousPageCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.PreviousPage}"/>
                            <dxpbars:NextPageBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.NextPageCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.NextPage}"/>
                            <dxpbars:LastPageBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.LastPageCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.LastPage}"/>
                            <dxpbars:NavigationPaneBarCheckItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleNavigationPaneCommand, RelativeSource={RelativeSource TemplatedParent}}"
                                                                dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.NavigationPane}"
                                                                IsVisible="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).UseOfficeInspiredNavigationPane, RelativeSource={RelativeSource TemplatedParent}}"/>
                        </dxr:RibbonPageGroup>
                        <dxr:RibbonPageGroup Caption="{dxp:PrintingStringId StringId=RibbonPageGroup_Zoom}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.ZoomGroup}">
                            <dxpbars:ZoomOutBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ZoomOutCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.ZoomOut}"/>
                            <dxpbars:ZoomBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ZoomCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Zoom}"/>
                            <dxpbars:ZoomInBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ZoomInCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.ZoomIn}"/>
                        </dxr:RibbonPageGroup>
                        <dxr:RibbonPageGroup Caption="{dxp:PrintingStringId StringId=RibbonPageGroup_View}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.ViewGroup}">
                            <dxpbars:PageLayoutBarSubItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SetPageLayoutSplitCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.PageLayoutSplit}"/>
                            <dxb:BarItemSeparator/>
                            <dxpbars:ContinuousScrollingBarCheckItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleEnableContinuousScrollingCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.ContinuousScrolling}"/>
                            <dxpbars:CoverPageBarCheckItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleShowCoverPageCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.ShowCoverPage}"/>
                        </dxr:RibbonPageGroup>
                        <dxr:RibbonPageGroup Caption="{dxp:PrintingStringId StringId=RibbonPageGroup_Export}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.ExportGroup}">
                            <dxpbars:ExportSplitItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ExportSplitCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Export}"/>
                            <dxpbars:SendSplitItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SendSplitCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Send}"/>
                        </dxr:RibbonPageGroup>
                        <dxr:RibbonPageGroup Caption="{dxp:PrintingStringId StringId=RibbonPageGroup_Document}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.DocumentGroup}">
                            <dxpbars:ParametersBarCheckItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleParametersPanelCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Parameters}"/>
                            <dxpbars:DocumentMapBarCheckItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleDocumentMapCommand, RelativeSource={RelativeSource TemplatedParent}}"
                                                             dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.DocumentMap}"
                                                             IsVisible="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).UseOfficeInspiredNavigationPane, RelativeSource={RelativeSource TemplatedParent}, Converter={dxmvvm:BooleanNegationConverter}, FallbackValue=False}"/>
                            <dxpbars:ThumbnailsBarCheckItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleThumbnailsCommand, RelativeSource={RelativeSource TemplatedParent}}"
                                                            dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Thumbnails}"
                                                            IsVisible="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).UseOfficeInspiredNavigationPane, RelativeSource={RelativeSource TemplatedParent}, Converter={dxmvvm:BooleanNegationConverter}, FallbackValue=False}"/>
                            <dxpbars:EditingFieldsBarCheckItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleEditingFieldsCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.EditingFields}"/>
                            <dxpbars:FindTextBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ShowFindTextCommand, RelativeSource={RelativeSource TemplatedParent}}"
                                                     CommandParameter="{StaticResource TrueBoolean}"
                                                     dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Find}"
                                                     IsVisible="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).UseOfficeInspiredNavigationPane, RelativeSource={RelativeSource TemplatedParent}, Converter={dxmvvm:BooleanNegationConverter}, FallbackValue=False}"/>
                            <dxpbars:WatermarkBarItem Command="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SetWatermarkCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Watermark}"/>
                        </dxr:RibbonPageGroup>
                    </dxr:RibbonPage>
                </dxr:RibbonDefaultPageCategory>
            </dxr:RibbonControl>
            <ContentControl ContentTemplate="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=PresenterTemplate}}"
                            Focusable="False"
                            Grid.Row="1"
                            UseLayoutRounding="True"/>
            <dxr:RibbonStatusBarControl dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.StatusBar}"
                                        Focusable="False"
                                        Grid.Row="2">
                <dxr:RibbonStatusBarControl.LeftItems>
                    <dxpbars:PageNumberEditItem dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.PageNumber}" SettingsSource="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer), RelativeSource={RelativeSource TemplatedParent}}"/>
                    <dxpbars:ProgressEditItem dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.Progress}" ProgressSettings="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).Document, RelativeSource={RelativeSource TemplatedParent}, FallbackValue={x:Null}}"/>
                    <dxpbars:StopPageBuildItem Command="{Binding  Path=(dxp:DocumentPreviewControl.ActualViewer).ActualCommandProvider.StopPageBuildingCommand, RelativeSource={RelativeSource TemplatedParent}}" dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.StopBuilding}"/>
                </dxr:RibbonStatusBarControl.LeftItems>
                <dxr:RibbonStatusBarControl.RightItems>
                    <dxpbars:ZoomFactorEditItem dxp:DocumentPreviewControl.BarItemName="{x:Static dxpbars:DefaultPreviewBarItemNames.ZoomFactor}" SettingsSource="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer), RelativeSource={RelativeSource TemplatedParent}}"/>
                </dxr:RibbonStatusBarControl.RightItems>
            </dxr:RibbonStatusBarControl>
        </Grid>
    </DataTemplate>

    <ControlTemplate x:Key="{dxpt:NewDocumentViewerThemeKey ResourceKey=ScrollViewerTemplate}" TargetType="{x:Type dxpn:PreviewScrollViewer}">
        <Grid x:Name="Grid"
              Background="{TemplateBinding Background}"
              Margin="{TemplateBinding Margin}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <ScrollContentPresenter x:Name="PART_ScrollContentPresenter"
                                    CanContentScroll="{TemplateBinding CanContentScroll}"
                                    CanHorizontallyScroll="False"
                                    CanVerticallyScroll="False"
                                    Margin="{TemplateBinding Padding}">
                <Grid.RowSpan>
                    <Binding Path="(dx:ScrollBarExtensions.ScrollBarMode)" RelativeSource="{RelativeSource TemplatedParent}">
                        <Binding.Converter>
                            <dx:EnumToObjectConverter DefaultValue="1">
                                <dx:EnumToObjectConverter.Values>
                                    <dx:EnumObjectProvider x:Key="TouchOverlap" Value="2"/>
                                </dx:EnumToObjectConverter.Values>
                            </dx:EnumToObjectConverter>
                        </Binding.Converter>
                    </Binding>
                </Grid.RowSpan>
                <Grid.ColumnSpan>
                    <Binding Path="(dx:ScrollBarExtensions.ScrollBarMode)" RelativeSource="{RelativeSource TemplatedParent}">
                        <Binding.Converter>
                            <dx:EnumToObjectConverter DefaultValue="1">
                                <dx:EnumToObjectConverter.Values>
                                    <dx:EnumObjectProvider x:Key="TouchOverlap" Value="2"/>
                                </dx:EnumToObjectConverter.Values>
                            </dx:EnumToObjectConverter>
                        </Binding.Converter>
                    </Binding>
                </Grid.ColumnSpan>
            </ScrollContentPresenter>
            <ScrollBar x:Name="PART_VerticalScrollBar"
                       AutomationProperties.AutomationId="VerticalScrollBar"
                       Cursor="Arrow"
                       Grid.Column="1"
                       Grid.Row="0"
                       Maximum="{TemplateBinding ScrollableHeight}"
                       Minimum="0"
                       Value="{Binding Path=VerticalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                       ViewportSize="{TemplateBinding ViewportHeight}"
                       Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}">
                <Grid.RowSpan>
                    <MultiBinding>
                        <MultiBinding.Bindings>
                            <Binding Path="(dx:ScrollBarExtensions.ScrollBarMode)" RelativeSource="{RelativeSource Self}"/>
                            <Binding Path="(dx:ScrollBarExtensions.ScrollViewerOrientation)" RelativeSource="{RelativeSource TemplatedParent}"/>
                        </MultiBinding.Bindings>
                        <MultiBinding.Converter>
                            <dx:VerticalScrollBarRowSpanConverter/>
                        </MultiBinding.Converter>
                    </MultiBinding>
                </Grid.RowSpan>
            </ScrollBar>
            <ScrollBar x:Name="PART_HorizontalScrollBar"
                       AutomationProperties.AutomationId="HorizontalScrollBar"
                       Cursor="Arrow"
                       Grid.Column="0"
                       Grid.Row="1"
                       Maximum="{TemplateBinding ScrollableWidth}"
                       Minimum="0"
                       Orientation="Horizontal"
                       Value="{Binding Path=HorizontalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                       ViewportSize="{TemplateBinding ViewportWidth}"
                       Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}">
                <Grid.ColumnSpan>
                    <MultiBinding>
                        <MultiBinding.Bindings>
                            <Binding Path="(dx:ScrollBarExtensions.ScrollBarMode)" RelativeSource="{RelativeSource Self}"/>
                            <Binding Path="(dx:ScrollBarExtensions.ScrollViewerOrientation)" RelativeSource="{RelativeSource TemplatedParent}"/>
                        </MultiBinding.Bindings>
                        <MultiBinding.Converter>
                            <dx:HorizontalScrollBarRowSpanConverter/>
                        </MultiBinding.Converter>
                    </MultiBinding>
                </Grid.ColumnSpan>
            </ScrollBar>
            <Border x:Name="Corner"
                    Grid.Column="1"
                    Grid.Row="1"
                    Style="{DynamicResource {dxt:ScrollBarThemeKey ResourceKey=ScrollingCornerStyle}}">
                <Border.Visibility>
                    <Binding Path="(dx:ScrollBarExtensions.ScrollBarMode)" RelativeSource="{RelativeSource TemplatedParent}">
                        <Binding.Converter>
                            <dx:EnumToObjectConverter DefaultValue="Visible">
                                <dx:EnumToObjectConverter.Values>
                                    <dx:EnumObjectProvider x:Key="TouchOverlap" Value="Collapsed"/>
                                </dx:EnumToObjectConverter.Values>
                            </dx:EnumToObjectConverter>
                        </Binding.Converter>
                    </Binding>
                </Border.Visibility>
                <dx:BackgroundPanel/>
            </Border>
            <dxe:FlyoutControl x:Name="PART_FlyoutControl"
                               AllowMoveAnimation="False"
                               ContentTemplate="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=PaginationTemplate}}"
                               IsOpen="False"
                               PlacementTarget="{Binding ElementName=PART_VerticalScrollBar}"
                               VerticalAlignment="Center">
                <dxe:FlyoutControl.Settings>
                    <dxe:FlyoutSettings Placement="Left" ShowIndicator="True"/>
                </dxe:FlyoutControl.Settings>
            </dxe:FlyoutControl>
        </Grid>
    </ControlTemplate>

    <DataTemplate x:Key="{dxpt:NewDocumentViewerThemeKey ResourceKey=SelectionCanvasContentTemplate}">
        <Border Background="#45007FFF"
                BorderBrush="#FF007FFF"
                BorderThickness="1"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch"
                cs:id="Border_0001"/>
    </DataTemplate>

    <ControlTemplate x:Key="{dxpt:NewDocumentViewerThemeKey ResourceKey=SelectionCanvasTemplate}" TargetType="{x:Type dxpn:SelectionCanvas}">
        <Canvas x:Name="PART_SelectionCanvas" ClipToBounds="True">
            <ContentControl Canvas.Left="{Binding Path=(SelectionRectangle).X, RelativeSource={RelativeSource TemplatedParent}}"
                            Canvas.Top="{Binding Path=(SelectionRectangle).Y, RelativeSource={RelativeSource TemplatedParent}}"
                            Content="{Binding Path=SelectionRectangle, RelativeSource={RelativeSource TemplatedParent}}"
                            ContentTemplate="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=SelectionCanvasContentTemplate}}"
                            Focusable="False"
                            Height="{Binding Path=(SelectionRectangle).Height, RelativeSource={RelativeSource TemplatedParent}}"
                            Width="{Binding Path=(SelectionRectangle).Width, RelativeSource={RelativeSource TemplatedParent}}"/>
        </Canvas>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxpt:NewDocumentViewerThemeKey ResourceKey=PageSelectorTemplate}" TargetType="{x:Type dxpn:PageSelector}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="{Binding Path=VerticalScrollBarWidth, ElementName=PART_ScrollViewer}"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <dxdv:DocumentPresenterDecorator x:Name="PART_Decorator"
                                             Focusable="True"
                                             FocusVisualStyle="{x:Null}"
                                             Grid.ColumnSpan="2"
                                             Grid.RowSpan="2">
                <Grid>
                    <dxpn:PreviewScrollViewer x:Name="PART_ScrollViewer"
                                              CanContentScroll="True"
                                              CanMouseScroll="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).CursorMode, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource cursorModeToCanMouseScrollConverter}}"
                                              dx:ScrollBarExtensions.ScrollBehavior="{dx:ScrollViewerScrollBehavior}"
                                              FlowDirection="{Binding FlowDirection, RelativeSource={RelativeSource AncestorType=dxp:DocumentPreviewControl}}"
                                              Focusable="false"
                                              Padding="{TemplateBinding Padding}"
                                              Template="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=ScrollViewerTemplate}}">
                        <dxmvvm:Interaction.Behaviors>
                            <dxpn:CursorAttachedBehavior CursorMode="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).CursorMode, RelativeSource={RelativeSource TemplatedParent}}"/>
                            <dx:ScrollViewerTouchBehavior Orientation="Vertical"/>
                        </dxmvvm:Interaction.Behaviors>
                        <ItemsPresenter x:Name="PART_ItemsPresenter" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                    </dxpn:PreviewScrollViewer>
                </Grid>
            </dxdv:DocumentPresenterDecorator>
            <dxpn:SelectionCanvas SelectionRectangle="{Binding Path=SelectionRectangle, RelativeSource={RelativeSource AncestorType=dxp:DocumentPresenterControl}}"/>
            <dx:DXExpander HorizontalAlignment="Stretch"
                           HorizontalExpand="FromLeftToRight"
                           IsExpanded="{Binding Path=IsSearchControlVisible, RelativeSource={RelativeSource TemplatedParent}}"
                           Opacity="{Binding Path=AnimationProgress, RelativeSource={RelativeSource Self}}"
                           VerticalAlignment="Top">
                <dxdv:SearchControlContainer IsSearchControlVisible="{Binding Path=IsSearchControlVisible, RelativeSource={RelativeSource TemplatedParent}}" SearchParameter="{Binding Path=SearchParameter, RelativeSource={RelativeSource TemplatedParent}}"/>
            </dx:DXExpander>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxpt:NewDocumentViewerThemeKey ResourceKey=DocumentPresenterTemplate}" TargetType="{x:Type dxp:DocumentPresenterControl}">
        <Border Focusable="False">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition/>
                </Grid.RowDefinitions>
                <TextBlock Background="Transparent"
                           FontWeight="Bold"
                           HorizontalAlignment="Center"
                           Text="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).Document.DocumentStatus, UpdateSourceTrigger=PropertyChanged, Converter={dxpn:DocumentStatusToTextConverter}, RelativeSource={RelativeSource TemplatedParent}}"
                           TextAlignment="Center"
                           VerticalAlignment="Center"
                           Visibility="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).Document.DocumentStatus, Converter={dxpn:DocumentStatusToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged, RelativeSource={RelativeSource TemplatedParent}}"
                           cs:id="TextBlock_0000"/>
                <Grid Name="renderContainer">
                    <dxe:NativeImage x:Name="PART_NativeImage" Focusable="False"/>
                    <dxpn:PageSelector x:Name="PART_ItemsControl"
                                       Background="Transparent"
                                       IsSearchControlVisible="{Binding Path=IsSearchControlVisible, RelativeSource={RelativeSource TemplatedParent}}"
                                       SearchParameter="{Binding Path=SearchParameter, RelativeSource={RelativeSource TemplatedParent}}"
                                       VirtualizingStackPanel.VirtualizationMode="Recycling"
                                       cs:id="PageSelector_0000">
                        <dxpn:PageSelector.ItemsPanel>
                            <ItemsPanelTemplate>
                                <dxdv:DocumentViewerPanel Name="itemsHost"
                                                          FlowDirection="LeftToRight"
                                                          IsItemsHost="True"/>
                            </ItemsPanelTemplate>
                        </dxpn:PageSelector.ItemsPanel>
                    </dxpn:PageSelector>
                </Grid>
            </Grid>
        </Border>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxpt:NewDocumentViewerThemeKey ResourceKey=Template}" TargetType="{x:Type dxp:DocumentPreviewControl}">
        <ContentControl ContentTemplate="{Binding Path=ActualBarsTemplate, RelativeSource={RelativeSource TemplatedParent}}"
                        Focusable="False"
                        Grid.ColumnSpan="3"
                        Grid.RowSpan="3"/>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxpt:NewDocumentViewerThemeKey ResourceKey=DocumentMapTemplate}" TargetType="{x:Type dxpn:DocumentMap}">
        <dxg:GridControl x:Name="PART_GridControl"
                         CurrentItem="{Binding SelectedItem, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}"
                         Grid.Row="1"
                         ItemsSource="{TemplateBinding ActualSource}"
                         SelectedItem="{Binding SelectedItem, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}, UpdateSourceTrigger=PropertyChanged}"
                         SelectionMode="Row"
                         ShowBorder="False">
            <dxmvvm:Interaction.Behaviors>
                <dxmvvm:KeyToCommand Command="{x:Static dxdv:DocumentMapCommands.GoToNodeCommand}"
                                     CommandParameter="{Binding Path=CurrentItem, ElementName=PART_GridControl}"
                                     EventName="PreviewKeyDown"
                                     KeyGesture="Enter"
                                     MarkRoutedEventsAsHandled="True"/>
                <dxmvvm:KeyToCommand Command="{x:Static dxdv:DocumentMapCommands.GoToNodeCommand}"
                                     CommandParameter="{Binding Path=CurrentItem, ElementName=PART_GridControl}"
                                     EventName="PreviewKeyDown"
                                     KeyGesture="Space"
                                     MarkRoutedEventsAsHandled="True"/>
            </dxmvvm:Interaction.Behaviors>
            <dxg:GridControl.View>
                <dxg:TreeListView x:Name="PART_TreeView" Style="{TemplateBinding TreeViewStyle}">
                    <dxg:TreeListView.FormatConditions>
                        <dxg:FormatCondition ApplyToRow="True"
                                             Expression="[IsHighlighted] = True"
                                             FieldName="IsHighlighted">
                            <dxg:FormatCondition.Format>
                                <dx:Format Background="#FFFFEE80"
                                           Foreground="#FF2B579A"
                                           cs:id="Format_0001"/>
                            </dxg:FormatCondition.Format>
                        </dxg:FormatCondition>
                    </dxg:TreeListView.FormatConditions>
                    <dxg:TreeListView.RowCellMenuCustomizations>
                        <dxb:BarButtonItem Command="{x:Static dxdv:DocumentMapCommands.GoToNodeCommand}"
                                           CommandParameter="{Binding Path=CurrentItem, ElementName=PART_GridControl}"
                                           CommandTarget="{Binding ElementName=PART_GridControl}"
                                           Content="{dxdv:DocumentViewerControlLocalizedString DocumentMapGoToCaption}"/>
                    </dxg:TreeListView.RowCellMenuCustomizations>
                    <dxmvvm:Interaction.Behaviors>
                        <dxmvvm:EventToCommand Command="{x:Static dxdv:DocumentMapCommands.GoToNodeCommand}" EventName="MouseLeftButtonUp">
                            <dxmvvm:EventToCommand.EventArgsConverter>
                                <dxdv:MouseEventArgsToDataRowConverter ChangedButton="Left"/>
                            </dxmvvm:EventToCommand.EventArgsConverter>
                        </dxmvvm:EventToCommand>
                    </dxmvvm:Interaction.Behaviors>
                </dxg:TreeListView>
            </dxg:GridControl.View>
            <dxg:GridControl.Columns>
                <dxg:GridColumn FieldName="Title"/>
            </dxg:GridControl.Columns>
        </dxg:GridControl>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxpt:NewDocumentViewerThemeKey ResourceKey=ThumbnailsTemplate}" TargetType="{x:Type dxpn:ThumbnailsViewerControl}">
        <Grid>
            <dxpn:ThumbnailsPresenterControl PageDisplayMode="Wrap"/>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxpt:NewDocumentViewerThemeKey ResourceKey=ThumbnailsPresenterTemplate}" TargetType="{x:Type dxpn:ThumbnailsPresenterControl}">
        <Grid>
            <dxe:NativeImage x:Name="PART_NativeImage"/>
            <dxpn:ThumbnailsPageSelector x:Name="PART_ItemsControl">
                <dxpn:ThumbnailsPageSelector.ItemsPanel>
                    <ItemsPanelTemplate>
                        <dxdv:DocumentViewerPanel x:Name="PART_DocumentViewerPanel"/>
                    </ItemsPanelTemplate>
                </dxpn:ThumbnailsPageSelector.ItemsPanel>
            </dxpn:ThumbnailsPageSelector>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxpt:NewDocumentViewerThemeKey ResourceKey=PageControlItemTemplate}" TargetType="{x:Type dxp:PreviewPageControlItem}">
        <Grid Margin="1">
            <ContentControl Content="{Binding}"
                            ContentTemplate="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=PageBorderTemplate}}"
                            IsHitTestVisible="False"/>
            <dxpn:PageMarginsEditor Margin="-1"
                                    Page="{Binding}"
                                    Zoom="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ZoomFactor, RelativeSource={RelativeSource Self}}"/>
        </Grid>
    </ControlTemplate>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Native.ThumbnailPageControlItem}" TargetType="{x:Type dxpn:ThumbnailPageControlItem}">
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="VerticalAlignment" Value="Bottom"/>
        <Setter Property="IsSelected" Value="{Binding Path=IsSelected}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type dxpn:ThumbnailPageControlItem}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <ContentControl Content="{Binding}"
                                        ContentTemplate="{DynamicResource ResourceKey={dxpt:NewDocumentViewerThemeKey ResourceKey=PageBorderTemplate}}"
                                        IsHitTestVisible="False"/>
                        <TextBlock Grid.Row="1"
                                   Margin="0,5,0,5"
                                   Text="{Binding Path=PageNumber}"
                                   TextAlignment="Center"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Native.ThumbnailsViewerControl}" TargetType="{x:Type dxpn:ThumbnailsViewerControl}">
        <Setter Property="Template" Value="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=ThumbnailsTemplate}}"/>
    </Style>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Native.ThumbnailsPresenterControl}" TargetType="{x:Type dxpn:ThumbnailsPresenterControl}">
        <Setter Property="Template" Value="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=ThumbnailsPresenterTemplate}}"/>
    </Style>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Native.ThumbnailsPageSelector}" TargetType="{x:Type dxpn:ThumbnailsPageSelector}">
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type dxpn:ThumbnailsPageSelector}">
                    <Grid>
                        <dxdv:DocumentPresenterDecorator x:Name="PART_Decorator"
                                                         Focusable="True"
                                                         FocusVisualStyle="{x:Null}"
                                                         Grid.ColumnSpan="2"
                                                         Grid.RowSpan="2">
                            <dxpn:PreviewScrollViewer x:Name="PART_ScrollViewer"
                                                      CanContentScroll="True"
                                                      CanMouseScroll="True"
                                                      dx:ScrollBarExtensions.ScrollBehavior="{dx:ScrollViewerScrollBehavior}"
                                                      dx:ScrollViewerTouchBehavior.IsEnabled="True"
                                                      Focusable="false"
                                                      HorizontalScrollBarVisibility="Auto"
                                                      Padding="{TemplateBinding Padding}"
                                                      ShowFlyoutOnScroll="False"
                                                      Template="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=ScrollViewerTemplate}}"
                                                      VerticalScrollBarVisibility="Auto">
                                <dxmvvm:Interaction.Behaviors>
                                    <dx:ScrollViewerTouchBehavior Orientation="Vertical"/>
                                </dxmvvm:Interaction.Behaviors>
                                <ItemsPresenter x:Name="PART_ItemsPresenter"/>
                            </dxpn:PreviewScrollViewer>
                        </dxdv:DocumentPresenterDecorator>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Native.DocumentMap}" TargetType="{x:Type dxpn:DocumentMap}">
        <Setter Property="TreeViewStyle" Value="{DynamicResource {dxdvt:DocumentViewerThemeKey ResourceKey=TreeViewStyle}}"/>
        <Setter Property="Template" Value="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=DocumentMapTemplate}}"/>
    </Style>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewPageControlItem}" TargetType="{x:Type dxp:PreviewPageControlItem}">
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="IsSelected" Value="{Binding IsSelected}"/>
        <Setter Property="Template" Value="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=PageControlItemTemplate}}"/>
    </Style>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Native.SelectionCanvas}" TargetType="{x:Type dxpn:SelectionCanvas}">
        <Setter Property="Template" Value="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=SelectionCanvasTemplate}}"/>
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="IsHitTestVisible" Value="False"/>
    </Style>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Native.PageSelector}" TargetType="{x:Type dxpn:PageSelector}">
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="Template" Value="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=PageSelectorTemplate}}"/>
    </Style>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.DocumentPresenterControl}" TargetType="{x:Type dxp:DocumentPresenterControl}">
        <Setter Property="MinHeight" Value="10"/>
        <Setter Property="FlowDirection" Value="LeftToRight"/>
        <Setter Property="Template" Value="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=DocumentPresenterTemplate}}"/>
    </Style>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.DocumentPreviewControl}" TargetType="{x:Type dxp:DocumentPreviewControl}">
        <Setter Property="HighlightSelectionColor" Value="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=HighlightSelectionColor}}"/>
        <Setter Property="BarsTemplate" Value="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=BarsTemplate}}"/>
        <Setter Property="RibbonTemplate" Value="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=RibbonTemplate}}"/>
        <Setter Property="PresenterTemplate" Value="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=PresenterTemplate}}"/>
        <Setter Property="Template" Value="{DynamicResource {dxpt:NewDocumentViewerThemeKey ResourceKey=Template}}"/>
        <Setter Property="dx:ScrollBarExtensions.ScrollBarMode" Value="TouchOverlap"/>
    </Style>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Native.PageMarginsEditor}" TargetType="{x:Type dxpn:PageMarginsEditor}">
        <Setter Property="Visibility">
            <Setter.Value>
                <MultiBinding Converter="{dxpn:PageViewModelToPageMarginsVisibilityConverter}">
                    <Binding/>
                    <Binding Path="(dxp:DocumentPreviewControl.ActualViewer).CurrentPageNumber" RelativeSource="{RelativeSource Self}"/>
                </MultiBinding>
            </Setter.Value>
        </Setter>
        <Setter Property="IsEnabled" Value="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).Document.CanChangePageSettings, RelativeSource={RelativeSource Self}}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="dxpn:PageMarginsEditor">
                    <Grid Name="Margins"
                          ClipToBounds="True"
                          Visibility="{Binding Path=(dxp:DocumentPreviewControl.ActualViewer).ShowPageMargins, RelativeSource={RelativeSource Self}, Converter={dx:BooleanToVisibilityConverter}}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="{Binding TopMargin.Size, RelativeSource={RelativeSource TemplatedParent}}"
                                           MaxHeight="{Binding TopMargin.MaxSize, RelativeSource={RelativeSource TemplatedParent}}"
                                           MinHeight="0"/>
                            <RowDefinition Height="auto"/>
                            <RowDefinition Height="*" MinHeight="1"/>
                            <RowDefinition Height="auto"/>
                            <RowDefinition Height="{Binding BottomMargin.Size, RelativeSource={RelativeSource TemplatedParent}}"
                                           MaxHeight="{Binding BottomMargin.MaxSize, RelativeSource={RelativeSource TemplatedParent}}"
                                           MinHeight="0"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition MaxWidth="{Binding LeftMargin.MaxSize, RelativeSource={RelativeSource TemplatedParent}}"
                                              MinWidth="0"
                                              Width="{Binding LeftMargin.Size, RelativeSource={RelativeSource TemplatedParent}}"/>
                            <ColumnDefinition Width="auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="auto"/>
                            <ColumnDefinition MaxWidth="{Binding RightMargin.MaxSize, RelativeSource={RelativeSource TemplatedParent}}"
                                              MinWidth="0"
                                              Width="{Binding RightMargin.Size, RelativeSource={RelativeSource TemplatedParent}}"/>
                        </Grid.ColumnDefinitions>
                        <dxpn:MarginThumb Background="LightGray"
                                          Grid.Column="1"
                                          Grid.RowSpan="5"
                                          Orientation="Vertical"
                                          PageMargin="{Binding LeftMargin, RelativeSource={RelativeSource TemplatedParent}}"
                                          ResizeBehavior="PreviousAndNext"
                                          SetPageMarginCommand="{Binding Page.SetPageMarginCommand, RelativeSource={RelativeSource TemplatedParent}}"
                                          VerticalAlignment="Stretch"
                                          cs:id="MarginThumb_0000"/>
                        <dxpn:MarginThumb Background="LightGray"
                                          Grid.ColumnSpan="5"
                                          Grid.Row="1"
                                          HorizontalAlignment="Stretch"
                                          Orientation="Horizontal"
                                          PageMargin="{Binding TopMargin, RelativeSource={RelativeSource TemplatedParent}}"
                                          ResizeBehavior="PreviousAndNext"
                                          SetPageMarginCommand="{Binding SetPageMarginCommand}"
                                          cs:id="MarginThumb_0001"/>
                        <dxpn:MarginThumb Background="LightGray"
                                          Grid.Column="3"
                                          Grid.RowSpan="5"
                                          Orientation="Vertical"
                                          PageMargin="{Binding RightMargin, RelativeSource={RelativeSource TemplatedParent}}"
                                          ResizeBehavior="PreviousAndNext"
                                          SetPageMarginCommand="{Binding SetPageMarginCommand}"
                                          VerticalAlignment="Stretch"
                                          cs:id="MarginThumb_0002"/>
                        <dxpn:MarginThumb Background="LightGray"
                                          Grid.ColumnSpan="5"
                                          Grid.Row="3"
                                          HorizontalAlignment="Stretch"
                                          Orientation="Horizontal"
                                          PageMargin="{Binding BottomMargin, RelativeSource={RelativeSource TemplatedParent}}"
                                          ResizeBehavior="PreviousAndNext"
                                          SetPageMarginCommand="{Binding SetPageMarginCommand}"
                                          cs:id="MarginThumb_0003"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{dxt:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Native.MarginThumb}" TargetType="{x:Type dxpn:MarginThumb}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type dxpn:MarginThumb}">
                    <Grid Background="#00000000" cs:id="Grid_0000">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="MouseOver">
                                    <Storyboard>
                                        <ColorAnimationUsingKeyFrames Storyboard.TargetName="border" Storyboard.TargetProperty="(Shape.Stroke).(SolidColorBrush.Color)">
                                            <EasingColorKeyFrame KeyTime="0"
                                                                 Value="Gray"
                                                                 cs:id="EasingColorKeyFrame_0000"/>
                                        </ColorAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Disabled"/>
                                <VisualState x:Name="Pressed"/>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <dxpn:NoSizeDecorator>
                            <Line Name="border"
                                  HorizontalAlignment="Stretch"
                                  Stroke="LightGray"
                                  StrokeDashArray="1 1"
                                  StrokeThickness="5"
                                  VerticalAlignment="Stretch"
                                  X2="{Binding ActualWidth, RelativeSource={RelativeSource TemplatedParent}}"
                                  Y2="{Binding ActualHeight, RelativeSource={RelativeSource TemplatedParent}}"
                                  cs:id="Line_0000"/>
                        </dxpn:NoSizeDecorator>
                        <ToolTipService.ToolTip>
                            <ToolTip x:Name="PART_Tooltip"
                                     Placement="Mouse"
                                     Visibility="{Binding IsDragging, RelativeSource={RelativeSource TemplatedParent}, Converter={dxmvvm:BooleanToVisibilityConverter HiddenInsteadOfCollapsed=True}}">
                                <ToolTip.Content>
                                    <MultiBinding Converter="{dxpn:MarginSideAndSizeToTextConverter}" FallbackValue="{x:Null}">
                                        <Binding Mode="OneWay"
                                                 Path="PageMargin.Side"
                                                 RelativeSource="{RelativeSource TemplatedParent}"/>
                                        <Binding Mode="OneWay"
                                                 Path="ActualSize"
                                                 RelativeSource="{RelativeSource TemplatedParent}"/>
                                    </MultiBinding>
                                </ToolTip.Content>
                            </ToolTip>
                        </ToolTipService.ToolTip>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="Orientation" Value="Horizontal">
                            <Setter Property="Y2"
                                    TargetName="border"
                                    Value="1"/>
                            <Setter Property="Height"
                                    TargetName="border"
                                    Value="1"/>
                        </Trigger>
                        <Trigger Property="Orientation" Value="Vertical">
                            <Setter Property="X2"
                                    TargetName="border"
                                    Value="1"/>
                            <Setter Property="Width"
                                    TargetName="border"
                                    Value="1"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="Orientation" Value="Horizontal">
                <Setter Property="Height" Value="3"/>
            </Trigger>
            <Trigger Property="Orientation" Value="Vertical">
                <Setter Property="Width" Value="3"/>
            </Trigger>
        </Style.Triggers>
    </Style>

</ResourceDictionary>